<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head>  <title>Lab 5 for CMP 420, Spring 2003, Lehman College, CUNY</title>  </head><body bgcolor="#ffffff" link="#003399" vlink="#236b8e"> <h1>Laboratory Exercise 5</h1><h2><font>Database Modification (Command-line)</font></h2><h2>CMP 420: Database Systems<br> Lehman College, City University of New York<br>13 March 2003</h2><hr><h3>Unix Commands</h3>Each lab begins with several Unix commands that will be usefulfor completing today's lab and future labs and assignments.Try the following commands:<ul>  <li><pre>ls -la</pre>This command gives a listing of all the files in thecurrent directory preceded by the permissions on the files. &nbsp;For example:<pre>stjohn% ls -la<br>total 32<br>drwxr-xr-x   3 stjohn  staff    102 Feb  6 09:29 ./<br>drwxr-xr-x  34 stjohn  staff   1156 Mar 10 20:18 ../<br>-rw-r--r--   1 stjohn  staff  12558 Mar  3 18:38 index.html<br></pre>Note that the first column indicates whether or not its a directory (thusthe <tt>d</tt>), the next three letters indicate the permissionsfor the owner of the files, the next indicate the permissions for other usersin the owner's group, and the last three indicate the permissions for all others.So, the permissions on <tt>index.html</tt> say that it's not a directory, the owner (<tt>stjohn</tt>) has read and write permission, while the group and others have only read permission. The rest of the line indicates the number of links to the file,the owner, the group, the size of the file, the last day and time modified, followed by the file's name.</li>  <li><pre>chmod</pre>The <tt>chmod</tt> command changes the permissionson files. &nbsp;There are many options to this command. &nbsp;The easiestway to specify a change in permissions is by listing who ('u' for user, 'g'for group, and 'o' for others), whether the permission is to be added ('+')or taken away ('-'), and which permission you are changing ('r' for read,'w' for write, and 'x' for execute). &nbsp;For example, to remove write permissionfor group and others to the file <tt>index.html, you would</tt> type:<pre>chmod go-w index.html<br></pre><br clear="all">To make a file executable, for example, the perl file used below <tt>mk_examples.pl</tt>:<pre>chmod u+x mk_examples.pl<br></pre> &nbsp; &nbsp;</li></ul><h3>Creating Databases</h3>For today's lab, we're going to create a database to hold information aboutstudents and courses. &nbsp;This lab will have three tables: <tt>Students</tt>, <tt>Courses</tt>, and <tt>Enrollment</tt>. &nbsp;The <tt>Students</tt> table will keep track of students' ID number, name, address, and phone number. &nbsp;The <tt>Courses</tt> table will keep track of the courses' registration code, department, and course number. &nbsp;The <tt>Enrollment</tt> table will keep track of which students are enrolled in which courses. &nbsp;Since the<br><tt>IDNumber</tt> is the key for Students and <tt>registrationCode</tt> is the key for <tt>Courses</tt>, the <tt>Enrollment</tt> table will only need to store those two attributes to tell which students are enrolled in which courses.<br><br>First, create a database at the command line for today's lab (see <a href="lab2.html">Lab 2</a> for details). &nbsp;<br><br>Next, create the three tables in psql using the <tt>CREATE TABLE</tt> command. &nbsp;Details of this command can be found in Chapter 6 of the textbook or in the PostgreSQL manual (see the <a href="http://www.us.postgresql.org/users-lounge/docs/6.5/user/sql-commands.htm">list of commands</a>). &nbsp;The three tables should be:<br><ul>  <li><tt>Students(IDNumber,name,address,phone)</tt></li>  <li><tt>Courses(registrationCode,department,number)</tt></li>  <li><tt>Enrollment(IDNumber,registrationCode)</tt></li></ul>Check using the "\d" command to make sure all tables were created correctly.<br><h3>Making Data for your Database</h3>One way to enter the information into your database is to type in every lineby hand.&nbsp; Another way is to read in the database stored as a file.&nbsp;In Lab 2, we used a sample database from <a href="http://www.archonet.com/pgdocs/chap-exdb.html">PostgreSQL Notes</a>by Richard Huxton.&nbsp; For this lab, you need to modify his program tocreate data for today's database. &nbsp;First, download his perl program,and try running it (see directions on his webpage). &nbsp;It will createa data file much like that used for Lab 2. &nbsp;<br><br>Several quick hints for reading and modifying perl:<br><ul>  <li>Variables don't have to be declared. &nbsp;A variable that starts itsname with a "$" is assumed to be a scalar or single value (like $i or $name).&nbsp;A variable that starts its name with a "@" is assumed to be a listor an array.</li>  <li>All loops, decisions, and arithmetic that you learned in java will (likely) work in perl.</li>  <li>Methods or functions are at the end of the program and begin with the work <tt>sub</tt>.<br>  </li></ul><br>Next, modify the perl program to produce:<br><ul>  <li>100 students, based on 10 different first names, 10 different middle initials, and 10 different last names (see the <tt>$num_companies</tt> scalar variable and the lists used to hold first, middle, and last parts of names: <tt>@co_name1</tt>, <tt>@co_name2</tt>, <tt>@co_name3</tt>). &nbsp;For the IDNumber, use the index <tt>$i</tt> of the loop (so, the first student created will have <tt>IDNumber</tt> = 1, and the next will have <tt>IDNumber</tt> = 2, etc)</li>  <li>30 courses, based on 8 different <tt>department</tt> names and 10 different course <tt>numbers</tt>. &nbsp;Again, you can use the loop variable <tt>$i</tt> to create a unique <tt>registrationCode</tt>.</li>  <li>Modify the perl code that creates the <tt>orders</tt> table to randomly choose <tt>IDNumbers</tt> (between 1 and 100) and <tt>registrationCodes</tt> (between 1 and 30) and inserts 150 such pairs into the <tt>Enrollment</tt> table.<br>  </li>  <li>You can remove the perl code that creates the <tt>diary</tt> table<br>  </li></ul>Save the output of your perl program to a file. &nbsp;You might have to modifyit several times before it matches your database schema. Now, load it into<tt>psql</tt> and try some simple queries to make sure that it works.<br><h3>Database Modification</h3>Using the notes from class and the&nbsp;<a href="http://www.us.postgresql.org/users-lounge/docs/6.5/user/sql-commands.htm">list of commands</a> for PostgreSQL, find the commands that:<br><ul>  <li>delete a column from a table,</li>  <li>add a column to a table, and</li>  <li>change a column on a table.</li></ul><ul></ul><br><p></p><h3>Final Comments</h3>Before leaving the lab, you need to log out and shut down yourcomputer.  First, you should quit all applications.  Then,go to the <tt>K</tt> menu in the bottom left hand corner andselect <tt>Log Out</tt>.  Choose the <tt>Shut Down</tt> option,and shut off the monitor when you're done.<p>Remember to pick up any files you sent to the printer and totake any personal belongings.  It is difficult to get backinto the lab later (since it's locked when not in use), so,it's worth making sure you haven't forgotten anything.</p><br><br><br><br><br></body></html>