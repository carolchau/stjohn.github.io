<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Lab 6, LSP 350, Lehman College-- CUNY, Fall 2005</title></head>
<body bgcolor="#ffffff" link="#003399" vlink="#236b8e"> 


<h1>Laboratory Exercise 6<br>
</h1>
<h2>LSP 350: Computers &amp; Society<br>
Lehman College-- CUNY<br>2 November 2005</h2>
<h2></h2>

<hr>
<h3>Multitasking</h3>

<p>
Today's lab is on multitasking, or executing
more than one task at once.  We will modify the 
<a href="guidenqc/bumpbot1.nqc">bumpbot1.nqc</a>
to do two tasks at once-- the driving/bumping from before and
also playing music.

</p><p>
The second program will use a separate task to monitor the 
light sensor.  If the robot encounters a bright light, it 
will beep.  The main task (driving/bumping) will continue
independently of the light sensor activity.

</p><p><b>Design requirements:</b>  This lab assumes that the
two motors are wired to output ports A and C.  Further, each 
motor is attached to a means of locomotion (legs, treads,
feet, etc.).  When using the light sensor, it is wired to 
sensor port 2.  The touch sensor is wired to sensor port 1
and is attached to a bumper).

</p><h3>Musical Cars</h3>

Download <a href="guidenqc/bumpbot1.nqc">bumpbot1.nqc</a>.
Add a new task called <tt>play_music()</tt> that plays a
song (see <a href="sing.nqc">sing.nqc</a> for example).
Start your new task in the <tt>main()</tt> task.


<h3>Bright Lights, Big City</h3>

Next, write another program (using 
<a href="guidenqc/bumpbot1.nqc">bumpbot1.nqc</a>) with
a new task that beeps whenever a bright light is seen.
One way to this is with a <tt>while(true)</tt> loop that
checks if the light sensor is above a threshold.  
The program also should reverse and back up when it 
encounters an object.

<h3>Minimums and Maximums</h3>

It is often useful to have variables that are shared between
all the tasks.  These are called <b>global variables</b> and
are declared outside of any task, usually immediately after the
constant definitions.  For this next program we will use global
variables to keep track of the brightest and darkest readings.
Again, we'll <tt>bumpbot1.nqc</tt> as a starting point, so, copy
it to a new file and add the following global variables before the
<tt>main()</tt> task:

<pre>int min = 100;<br>int max = 0;<br></pre>

<tt>max</tt> will keep track of the highest reading (to start
with we set it to 0) and <tt>min</tt> will keep track of the
lowest.

The second program above has a separate task to monitor the 
light sensor.  If the robot encountered a bright light, it 
beeped.  The main task (driving/bumping) continued
independently of the light sensor activity.  Modify the 
light monitoring task to compare the current light value to
the minimum and maximum stored.  If it is larger than 
<tt>max</tt>, play the <tt>SOUND_UP</tt> tone and store the
new value in <tt>max</tt>.  If it is smaller than 
<tt>min</tt>, play the <tt>SOUND_DOWN</tt> tone and store the
new value in <tt>min</tt>.

<p>Try your program in an area with variable light.  At
first, it should beep a lot.  But after it has taken 
readings from more and more of the area, the beeps should
subside (since most of the values will fall in between the
minimum and maximum it saw earlier).


</p>
<h3>Finishing up for the Day<br>
</h3>


To get credit for this laboratory, you need to show and explain your
programs to Prof. St. John, as well as demonstrate that they run using
your robot.<br>


<br>


We must be out of the computer laboratory by 11:50am.&nbsp; As such, if
you
are not ready to demonstrate your work by 11:45am, you can do so in the
next laboratory.&nbsp; Before leaving the room, make sure that all
computers
and monitors are turned off, that any paper and trash have been
removed, and that all chairs are returned
to their proper places.&nbsp; Also, make sure you pack up your IR tower
in
your shoe box, since they're difficult to replace.
&nbsp;&nbsp;
<br>
</body></html>